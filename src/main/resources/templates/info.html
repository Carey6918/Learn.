<!DOCTYPE HTML>
<html xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>个人信息</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Facebook and Twitter integration -->
    <meta property="og:title" content=""/>
    <meta property="og:image" content=""/>
    <meta property="og:url" content=""/>
    <meta property="og:site_name" content=""/>
    <meta property="og:description" content=""/>
    <meta name="twitter:title" content="" />
    <meta name="twitter:image" content="" />
    <meta name="twitter:url" content="" />
    <meta name="twitter:card" content="" />


    <!-- Animate.css -->
    <link rel="stylesheet" href="css/animate.css">
    <!-- Icomoon Icon Fonts-->
    <link rel="stylesheet" href="css/icomoon.css">
    <!-- Bootstrap  -->
    <link rel="stylesheet" href="css/bootstrap.css">

    <!-- Magnific Popup -->
    <link rel="stylesheet" href="css/magnific-popup.css">

    <!-- Owl Carousel  -->
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/owl.theme.default.min.css">

    <!-- Theme style  -->
    <link rel="stylesheet" href="css/style.css">

    <script type="text/javascript" src="assets/js/jquery.min.js"></script>
    <script type="text/javascript" src="assets/js/jquery-ui.min.js"></script>
    <!-- Modernizr JS -->
    <script src="js/modernizr-2.6.2.min.js"></script>
    <!-- FOR IE9 below -->
    <!--[if lt IE 9]>
    <script src="js/respond.min.js"></script>
    <![endif]-->
    <script>
        function creditsExchange(){
            var type = $('input:radio[name="exchangeType"]:checked').val();
            $.ajax({
                type:'post',
                url:'/creditsExchange',
                data:{type:type},
                success:function (data) {
                    if(data==-1){
                        alert("积分不足！");
                    }else{
                        alert("兑换成功，您的余额为："+data+"元");
                        window.location.reload();
                    }
                }
            })
        }
    </script>

</head>
<body>

<div class="fh5co-loader"></div>

<div id="page">
    <nav class="fh5co-nav" role="navigation">
        <div class="top">
            <div class="container">
                <div class="row">
                    <div class="col-xs-12 text-right">
                        <p class="num">Call: +01 123 456 7890</p>
                        <ul class="fh5co-social">
                            <li><a href="#"><i class="icon-twitter"></i></a></li>
                            <li><a href="#"><i class="icon-dribbble"></i></a></li>
                            <li><a href="#"><i class="icon-github"></i></a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="top-menu">
            <div class="container">
                <div class="row">
                    <div class="col-xs-1">
                        <div id="fh5co-logo"><a href="index.html">Learn<span>.</span></a></div>
                    </div>
                    <div class="col-xs-11 text-right menu-1">
                        <ul>
                            <li ><a href="/index">首页</a></li>
                            <li><a href="/courses">订阅课程</a></li>
                            <li class="active"><a href="/info">个人信息</a></li>
                            <li class="has-dropdown">
                                <a href="/getOrderList">我订阅的</a>
                                <ul class="dropdown">
                                    <li><a href="/getOrderList?state=未开始">未开始</a></li>
                                    <li><a href="/getOrderList?state=进行中">进行中</a></li>
                                    <li><a href="/getOrderList?state=已完成">已完成</a></li>
                                    <li><a href="/getOrderList?state=已退订">已退订</a></li>
                                </ul>
                            </li>
                            <li><a href="/contact">联系我们</a></li>

                            <li class="btn-cta"><a href="/logout"><span>注销</span></a></li>
                            <li class="btn-cta"><a href="/applyInstitution"><span>申请机构</span></a></li>
                        </ul>
                    </div>
                </div>

            </div>
        </div>
    </nav>

    <header id="fh5co-header" class="fh5co-cover fh5co-cover-sm" role="banner" data-stellar-background-ratio="0.5">
        <div class="overlay"></div>
        <div class="container">
            <div class="row">
                <div class="col-md-8 col-md-offset-2 text-center">
                    <div class="display-t">
                        <div class="display-tc animate-box" data-animate-effect="fadeIn">
                            <h1>个人信息</h1>
                            <h2>您可以修改您的个人信息，并查看您的积分与权限</h2>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div id="fh5co-contact">
        <div class="container">
            <div class="row">
                <div class="col-md-5 col-md-push-1 animate-box">

                    <div class="fh5co-contact-info">
                        <h3>您的信息</h3>
                        <form th:action="@{/saveInfo}" th:object="${user}">
                            <div class="row form-group">
                                <div class="col-md-12">
                                    <label for="fname">账号：</label>
                                    <input type="text" id="fname" class="form-control" th:value="${user.email}" th:field="*{email}" readonly >
                                </div>

                            </div>
                            <div class="row form-group">
                                <div class="col-md-12">
                                    <label for="lname">姓名：</label>
                                    <input type="text" id="lname" class="form-control" th:value="${user.name}" th:field="*{name}">
                                </div>
                            </div>
                            <div class="row form-group">
                                <div class="col-md-6">
                                    <label for="email">年龄：</label>
                                    <input type="text" id="email" class="form-control"  th:value="${user.age}" th:field="*{age}">
                                </div>
                                <div class="col-md-6">
                                    <label for="subject">性别：</label>
                                    <input type="text" id="subject" class="form-control"  th:value="${user.sex}" th:field="*{sex}">
                                </div>
                            </div>



                            <div class="row form-group">
                                <div class="col-md-12">
                                    <label for="message">个人简介：</label>
                                    <textarea name="message" id="message" cols="30" rows="10" class="form-control" style="height: 150px;"></textarea>
                                </div>
                            </div>
                            <div class="form-group">
                                <input type="submit" value="修改信息" class="btn btn-primary">
                            </div>

                        </form>
                    </div>

                </div>
                <div class="col-md-6 animate-box" style="margin-left: 10%;width: 450px;">
                    <h3>您的积分</h3>
                    <label >会员等级：</label><lable th:text="${user.VIPlevel}"></lable><br>
                    <label >消费额度：</label><label th:text="${user.consumption}">30</label><br>
                    <label >当前积分：</label><label th:text="${user.points}">30</label><br>
                    <span>会员规则：<br>
                        达到500消费可升级至1级会员，享受95折优惠<br>
                        达到1000消费可升级至2级会员，享受9折优惠<br>
                        达到2000消费可升级至3级会员，享受85折优惠<br>
                        达到4000消费可升级至4级会员，享受8折优惠<br>
                        达到8000消费可升级至5级会员，享受75折优惠<br>

                    </span><br>
                    <label> 可兑换卡金额：</label>
                    <form>
                        <ul class="list">
                            <li>
                                <input  type="radio" id="1" value="0" name="exchangeType">
                                <label for="1">100积分换取5元卡金额。</label>
                            </li>
                            <li>
                                <input type="radio" id="2" value="1" name="exchangeType" >
                                <label for="2">500积分换取30元卡金额。</label>
                            </li>
                            <li>
                                <input type="radio" id="3" value="2" name="exchangeType">
                                <label for="3">1000积分换取80元卡金额。</label>
                            </li>
                            <li>
                                <input type="radio" id="4" value="3" name="exchangeType">
                                <label for="4">2000积分换取200元卡金额。</label>
                            </li>
                            <li>
                                <input type="radio" id="5" value="4" name="exchangeType">
                                <label for="5">3000积分换取400元卡金额。</label>
                            </li>
                        </ul>
                        <div class="form-group" style="    margin-top: 25px;">
                            <input type="button" value="确认兑换" class="btn btn-primary" onclick="creditsExchange()">
                        </div>
                    </form>

                </div>
            </div>
            <div class="row-fluid">
                <div class="widget widget-padding span12 col-md-10" style="
    left: 8.33333%; margin-top: 30px;">
                    <div class="widget-header">
                        <i class="icon-book"></i>
                        <h5 >您的消费信息</h5>
                        <div class="widget-buttons">
                            <a href="#" data-title="Collapse" data-collapsed="false" class="tip collapse"><i
                                    class="icon-chevron-up"></i></a>
                        </div>
                    </div>
                    <div class="widget-body">
                        <table  class="table table-striped table-bordered dataTable ">
                            <thead>
                            <tr>
                                <th>订单号</th>
                                <th>金额</th>
                                <th>原因</th>
                                <th>时间</th>
                            </tr>
                            </thead>
                            <tbody>

                            <tr th:each="consumption,iterStat : ${consumptionList}">
                                <td >
                                    <a th:text="${consumption.orderID}" th:href="'/orderInfo?orderID='+${consumption.orderID}"></a>
                                </td>
                                <td th:text="${consumption.price}"></td>
                                <td th:text="${consumption.reason}"></td>
                                <td th:text="${consumption.time}"></td>
                            </tr>

                            </tbody>
                        </table>
                    </div> <!-- /widget-body -->
                </div> <!-- /widget -->
            </div>
        </div>
    </div>
    <div class="widget  col-md-10" style="    left: 8.33333%;
    margin-top: 30px;">
        <div class="widget-header">
            <i class="icon-credit-card"></i>
            <h5>成交量</h5>
            <div class="widget-buttons">
                <a href="javascript:void(0)" class="collapse" data-collapsed="false"><i
                        data-title="Collapse" class="icon-chevron-up"></i></a>
            </div>
        </div>
        <div class="widget-body clearfix" >
            <div style="height:300px;" id="volume" class="widget-analytics-large"></div>
        </div>
    </div>
    <div class="widget  col-md-10" style="    left: 8.33333%;
    margin-top: 30px;">
        <div class="widget-header">
            <i class="icon-credit-card"></i>
            <h5>交易额</h5>
            <div class="widget-buttons">
                <a href="javascript:void(0)" class="collapse" data-collapsed="false"><i
                        data-title="Collapse" class="icon-chevron-up"></i></a>
            </div>
        </div>
        <div class="widget-body clearfix">
            <div style="height:300px;" id="profit" class="widget-analytics-large"></div>
        </div>
    </div>
    <div class="widget  col-md-5" style="    left: 8.33333%;
    margin-top: 30px;">
        <div class="widget-header">
            <i class="icon-credit-card"></i>
            <h5>各个机构所占的成交订单的百分比</h5>
            <div class="widget-buttons">
                <a href="javascript:void(0)" class="collapse" data-collapsed="false"><i
                        data-title="Collapse" class="icon-chevron-up"></i></a>
            </div>
        </div>
        <div class="widget-body clearfix">
            <div style="height:300px;" id="percent" class="widget-analytics-large"></div>
        </div>
    </div>
    <div class="widget  col-md-5" style="    left: 8.33333%;
    margin-top: 30px;">
        <div class="widget-header">
            <i class="icon-credit-card"></i>
            <h5>各个课程类型的平均成绩</h5>
            <div class="widget-buttons">
                <a href="javascript:void(0)" class="collapse" data-collapsed="false"><i
                        data-title="Collapse" class="icon-chevron-up"></i></a>
            </div>
        </div>
        <div class="widget-body clearfix">
            <div style="height:300px;" id="grade" class="widget-analytics-large"></div>
        </div>
    </div>
</div> <!-- /row-fluid -->

    <div class="row copyright">
        <div class="col-md-12 text-center">
            <p>
                <small class="block">&copy; 2018 PeiPei Company. All Rights Reserved. By - DieDie</small>
            </p>
        </div>
    </div>

</div>
</footer>
</div>

<div class="gototop js-top">
    <a href="#" class="js-gotop"><i class="icon-arrow-up"></i></a>
</div>

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery-ui.min.js"></script>
<!-- jQuery Easing -->
<script src="js/jquery.easing.1.3.js"></script>
<!-- Bootstrap -->
<script src="js/bootstrap.min.js"></script>
<!-- Waypoints -->
<script src="js/jquery.waypoints.min.js"></script>
<!-- Stellar Parallax -->
<script src="js/jquery.stellar.min.js"></script>
<!-- Carousel -->
<script src="js/owl.carousel.min.js"></script>
<!-- countTo -->
<script src="js/jquery.countTo.js"></script>
<!-- Magnific Popup -->
<script src="js/jquery.magnific-popup.min.js"></script>
<script src="js/magnific-popup-options.js"></script>
<!-- Main -->
<script type="text/javascript" src="assets/js/raphael-min.js"></script>
<script type="text/javascript" src="assets/js/bootstrap.js"></script>
<script type="text/javascript" src='assets/js/sparkline.js'></script>
<script type="text/javascript" src='assets/js/morris.min.js'></script>
<script type="text/javascript" src="assets/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.masonry.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.imagesloaded.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.facybox.js"></script>
<script type="text/javascript" src="assets/js/jquery.alertify.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.knob.js"></script>
<script type='text/javascript' src='assets/js/fullcalendar.min.js'></script>
<!--<script type='text/javascript' src='assets/js/jquery.gritter.min.js'></script>-->
<script type="text/javascript" src="assets/js/realm.js"></script>
<script type="text/javascript" src="assets/js/jquery.slimscroll.min.js"></script>
<script src="echarts/echarts.common.min.js"></script>
<script src="echarts/echarts.js"></script>
<!--<script src="echarts/echarts-all.js"></script>-->
<script src="js/main.js"></script>
<script th:inline="javascript">
    var profitChart = echarts.init(document.getElementById('profit'));
    profitChart.setOption({
        tooltip: {
            trigger: 'axis'
        },
        toolbox: {
            show: true,
            feature: {
                dataZoom: {
                    yAxisIndex: 'none'
                },
                mark: {show: true},
                dataView: {show: true, readOnly: true},

            }
        },

        calculable: true,
        xAxis: [
            {
                type: 'category',
                data: [[${dateList}]]
            }
        ],
        yAxis: [
            {
                type: 'value',
                splitArea: {show: true}
            }
        ],
        series: [
            {
                // name:'',
                type: 'line',
                data: [[${profitList}]]
            }

        ],
        dataZoom: [
            {
                show: true,
                realtime: true,

            }
        ],
    });
    var volumeChart = echarts.init(document.getElementById('volume'));
    volumeChart.setOption({
        tooltip: {
            trigger: 'axis'
        },
        toolbox: {
            show: true,
            feature: {
                mark: {show: true},
                dataView: {show: true, readOnly: true},

            }
        },
        calculable: true,
        xAxis: [
            {
                type: 'category',
                data: [[${dateList}]]
            }
        ],
        yAxis: [
            {
                type: 'value',
                splitArea: {show: true}
            }
        ],
        series: [
            {
                // name:'',
                type: 'bar',
                data: [[${volumeList}]]
            }

        ],
        dataZoom: [
            {
                show: true,
                realtime: true,

            },
            {
                type: 'inside',
                realtime: true,
            }
        ],
    });
    var percentChart = echarts.init(document.getElementById('percent'));
    var data = getInsPercentData();
    percentChart.setOption({
        tooltip : {
            trigger: 'item',
            formatter: "{a} <br/>{b} : {c} ({d}%)"
        },
        legend: {
            type: 'scroll',
            orient: 'vertical',
            right: 10,
            top: 20,
            bottom: 20,
            data:data.legendData
        },
        series : [
            {
                name: '机构',
                type: 'pie',
                radius : '55%',
                center: ['40%', '50%'],
                data:data.seriesData,
                itemStyle: {
                    emphasis: {
                        shadowBlur: 10,
                        shadowOffsetX: 0,
                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                    }
                }
            }
        ]
    });
    var gradeChart = echarts.init(document.getElementById('grade'));
    var data = getCourseGradeData();
    gradeChart.setOption({
        tooltip: {
            trigger: 'axis'
        },
        toolbox: {
            show: true,
            feature: {
                mark: {show: true},
                dataView: {show: true, readOnly: true},

            }
        },

        calculable: true,
        xAxis: [
            {
                type: 'category',
                data: data.legendData
            }
        ],
        yAxis: [
            {
                type: 'value',
                splitArea: {show: true}
            }
        ],
        series: [
            {
                // name:'',
                type: 'bar',
                data: data.seriesData
            }

        ]
    });
    window.onresize = function () {
        profitChart.resize();
        volumeChart.resize();
    }
    function getInsPercentData(){
        var inspercent = [[${insPercent}]];
        var legendData = [];
        var seriesData = [];
        for (var i = 0;i<inspercent.name.length;i++){
            var name = inspercent.name[i];
            legendData.push(name);
            seriesData.push({
                name: name,
                value: inspercent.value[i]
            });
        }
        return{
            legendData: legendData,
            seriesData: seriesData
        }
    }
    function getCourseGradeData(){
        var coursegrade = [[${courseGrade}]];
        var legendData = [];
        var seriesData = [];
        for (var i = 0;i<coursegrade.name.length;i++){
            var name = coursegrade.name[i];
            legendData.push(name);
            seriesData.push({
                name: name,
                value: coursegrade.value[i]
            });
        }
        return{
            legendData: legendData,
            seriesData: seriesData
        }
    }
</script>
</body>
</html>

